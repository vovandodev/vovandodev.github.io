<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Clouds, Virtualization and something more..."><meta name=Author content="Volodymyr Vrublevskyy"><meta name=keywords content="IT Talks"><link rel=stylesheet href=https://vovando.dev/css/syntax.css><link rel=stylesheet href=https://vovando.dev/css/style.css><script src=https://kit.fontawesome.com/1b7478c139.js crossorigin=anonymous></script><title>IT Talks</title></head><body><aside id=sidenav><header><a href=https://vovando.dev/><img src=https://vovando.dev/avatar.png alt=avatar></a>
<a id=branding href=https://vovando.dev/>IT Talks</a></header><nav><a href=/><i class="fas fa-home fa-sm"></i><span>whoami</span></a>
<a href=/posts><i class="fas fa-keyboard fa-ms"></i><span>blog</span></a>
<a href=/tags><i class="fas fa-tags fa-ms"></i><span>tags</span></a>
<a href=https://github.com/vovandodev target=_blank><i class="fab fa-github fa-ms"></i><span>github</span></a>
<a href=/index.xml><i class="fas fa-rss fa-ms"></i><span>RSS</span></a>
<a href=/contact><i class="far fa-envelope"></i><span>contact</span></a></nav></aside><main id=main><a href=javascript:void(0) id=closebtn onclick=navToggle()><i class="fas fa-bars fa-lg"></i></a><div class=content><h1 id=title>Packer with Azure</h1><nav id=TableOfContents></nav><p>Yes! It&rsquo;s works.</p><p>First of all you need to install packer. After that – Azure plugin for Packer (you could download executable package or compile proper package with **GOlang **placing it to directory with packer plugins).</p><p>In my case I used *.exe files, downloaded from Github release. Also you can find packer configuration for different OS here.</p><p>Lets analyze my configuration file and run packer to azure.</p><p> </p><p>{<br>  &ldquo;variables&rdquo;: {<br>    &ldquo;sn&rdquo;: &ldquo;Subscription1&rdquo;,<br>    &ldquo;ps&rdquo;: &ldquo;D:/azure/Subscription-credentials.publishsettings&rdquo;,<br>    &ldquo;sa&rdquo;: &ldquo;noteits&rdquo;,<br>    &ldquo;example_dir&rdquo;: &ldquo;D:/azure/example&rdquo;<br>  },<br>  &ldquo;builders&rdquo;: [<br>    {<br>      &ldquo;type&rdquo;: &ldquo;azure&rdquo;,<br>      &ldquo;publish_settings_path&rdquo;: &ldquo;{{user `ps`}}&rdquo;,<br>      &ldquo;subscription_name&rdquo;: &ldquo;{{user `sn`}}&rdquo;,<br>      &ldquo;storage_account&rdquo;: &ldquo;{{user `sa`}}&rdquo;,<br>      &ldquo;storage_account_container&rdquo;: &ldquo;images&rdquo;,<br>      &ldquo;os_type&rdquo;: &ldquo;Windows&rdquo;,<br>      &ldquo;os_image_label&rdquo;: &ldquo;Windows Server 2012 R2 Datacenter, September 2015&rdquo;,<br>      &ldquo;location&rdquo;: &ldquo;West US&rdquo;,<br>      &ldquo;instance_size&rdquo;: &ldquo;Small&rdquo;,<br>      &ldquo;user_image_label&rdquo;: &ldquo;WS2012R2DC&rdquo;<br>    }<br>  ],<br>  &ldquo;provisioners&rdquo;: [<br>    {<br>      &ldquo;type&rdquo;: &ldquo;azure-custom-script-extension&rdquo;,<br>      &ldquo;script_path&rdquo;: &ldquo;{{user `example_dir`}}/ws2012-setup.ps1&rdquo;<br>    }<br>  ]<br>}</p><p>So, we have Storage account named <strong>noteits</strong>. This name will be used in  &ldquo;storage_account&rdquo; field, as &ldquo;sa&rdquo; variable.</p><p>Then we need to obtain  &ldquo;publish_settings_path&rdquo;. Just run: </p><p>It is powershell cmdlet, you need to install Azure Powershell for proper work. </p><p>This command will open https://manage.windowsazure.com/publishsettings/index?client=powershell in browser and downloads file with subscription information.</p><p>Also configure OS Type and other settings, such as location, instant type, provision scripts and options, etc. </p><p>When everything is ready just run commend:</p><p><strong>packer.exe build -only=azure ws2012az.json</strong></p><p>Voila!</p><p><a href=http://noteits.net/wp-content/uploads/2015/11/packerazure.png></a></p><p> </p><div class=nav-next-prev><div class=nav-prev><a href=https://vovando.dev/2015/11/05/powershell-check-variable-for-null/><i class="fas fa-chevron-left"></i></a></div><a class=nav-top href=#>top</i></a><div class=nav-next><a href=https://vovando.dev/2015/11/23/adding-hyper-v-vhdx-in-an-azure-vm/><i class="fas fa-chevron-right"></i></a></div></div></div><footer><div class=footer-content><div class=contact-info><div class=footer-mail><i class="far fa-envelope"></i><a href=mailto:hello@vovando.dev>hello@vovando.dev</a></div><div class=footer-phone><i class="fas fa-phone"></i>7777</div></div><p class="copyright meta">Copyright © 2013–2020, all rights reserved.</p></div></footer></main></body><script src=https://vovando.dev/js/navbutton.js></script></html>